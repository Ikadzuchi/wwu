<h1>携帯⇔PC通信</h1>
市販ソフトは数千円で売られているが、そんなものを買う金は無いのでフリーソフトを使うことにした。<br>
<a href="http://hp.vector.co.jp/authors/VA013928/soft.html">KTrans</a>というソフトで、わりと有名なようだ。<br>
ケーブルは最近主流のUSBではなくシリアルケーブル。なぜなら安いから。秋葉原価格400円弱。<br>
<small>&nbsp;&nbsp;&nbsp;&nbsp;※まあUSBだってシリアルには違いないのだが(Universal <font color="#ff0000">Serial</font> Bus)、シリアルと言ったら普通は9ピンの<a href="http://e-words.jp/w/RS-232C.html">RS-232C</a>だ。</small><br>
最近秋葉原に行く機会が出来たので早速買ってきてつないだのだが動作しない。<br>
フリーソフトなのでつながる保障はないわけだが、一応動作報告もあるようだし、そもそも「Can't open COM1」とまで言われると何かもっと根本的なところでうまくいっていない気がする。<br>
まずポート番号を確かめてみる。と言ってもよく分からないのでCOM1〜COM9まで全部試してみる。が駄目だった。<br>
一応ソフトを変えてみる。同じ作者のKStoreやケーブルの袋に書いてあったソフトも試してみるが同様の結果。<br>
ケーブルを携帯にさすところで微妙につっかかりがあったのでカッターで恐る恐る削ってみる。が変わらず。冷静に考えれば動作報告があるのだから削る必要などあるはずもない。<br>
ネットで調べてみると、どうやらシリアルポートというのはデバイスマネージャーに表示されてしかるべきもののようだ。しかし自分のところでは出ていない。この辺に原因がありそうだ。<br>
まずはハードウェアの検索をかけたが見つからない。<br>
自力で探し出して無理やりドライバを設定してみるが、適合しないとの表示。案の定使えない。<br>
マザーボード(AOpen)の付属CDを引っ張り出してきてドライバを探してみるがシリアルポートのドライバは付属していない。一応色々なドライバを入れなおしてみるが変わらない。<br>
AOpenのHPにも行ってみて色々ドライバを探してみるもののシリアルポートのドライバというものはない。<br>
平行して携帯のほうでも通信速度設定とやらがあったので色々いじってみる。<br>
「Async/Fax」/「Packet」を変えてみたり。でもこれって「携帯〜(電波)〜基地局」の方の通信だよなぁ…。<br>
そんなある日、何気なく「aopen シリアルポート　ドライバ」を検索していると、<br>
「シリアルポート等とりあえず使用しない物はBIOS上で可能な限り Disableにしました。」<br>
という記述に目がとまる。<br>
BIOSでDisableできるもんなんだ、知らなかった。<br>
早速BIOSを見てみると、<br>
SERIAL 1 : DISABLE<br>
SERIAL 2 : DISABLE<br>
なんじゃこりゃ〜!<br>
誰だよこんな設定にしたやつ!<br>
と即ENABLEして起動すると、デバイスマネージャーに「COM1」の文字。先にドライバを無理やり入れた分も含めて2つ出ている。<br>
一応プロパティを見てみると「正常に機能しています」。<br>
これは…<br>
<img src="KTrans.png" alt="動作画面" title="恐ろしいことに公開当時電話番号をそのままにしていた。よくイタ電とか来なかったな…。"><br>
動いた〜♪<br>
長かったなあ、ここまでの道のり…。<br>
<img src="monitor.jpg" alt="ディスプレイ"><br>
↑ためしに携帯で撮って転送してみた。感無量。<br>
<br>
まあこんなことに数日かけるのがいやなら市販ソフトを買った方がいい。かけた時間を時給換算したら間違いなく損している。<br>
<br><br>
'07.1.21追記。<br>
ノートPC(のようなもの)とシリアルポートで通信しようとして色々いじっていたところ、携帯の通信がうまくいかなくなってしまった。(しかも肝心のノートPCとの通信も失敗)<br>
例の「Can't open COM1」表示が出る。<br>
後日ドライバを更新したり削除したり色々したところ何とか復活。どうやらデバイスマネージャからシリアルポートを削除すると直るようだ。<br>
しかしさらに後日、また使えなくなった。今度はデバイス削除でもうまくいかず散々悩んだが、ポートの詳細設定からバッファの値を最低にしたところ復活。<br>
ってことは最初デバイス削除で直ったのは偶然?<br />
<br />
'07.9/5追記。<br />
上ので治ったと思ったのは勘違いだったらしく、その後もやはり異常が多発。<br />
そこで思いついてシリアルポートの番号を変えてみると嘘のようにおさまった。<br />
要するにノートPC(のようなもの)の通信プログラムがシリアルポートを占領するようだ。<br />
ひどいソフトだなっていうか、なんで常駐してんの?<br />
<br />
<a href=".">＜戻る</a>